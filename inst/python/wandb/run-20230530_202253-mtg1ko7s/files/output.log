/Users/pierredemetz/miniconda3/envs/pierre/lib/python3.8/site-packages/haiku/_src/data_structures.py:143: FutureWarning: jax.tree_flatten is deprecated, and will be removed in a future release. Use jax.tree_util.tree_flatten instead.
  leaves, treedef = jax.tree_flatten(tree)
/Users/pierredemetz/miniconda3/envs/pierre/lib/python3.8/site-packages/haiku/_src/data_structures.py:144: FutureWarning: jax.tree_unflatten is deprecated, and will be removed in a future release. Use jax.tree_util.tree_unflatten instead.
  return jax.tree_unflatten(treedef, leaves)
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
epoch done with nan
Traceback (most recent call last):
  File "pierre_mochi__fit_tmodel_3state_doubledeepms.py", line 212, in <module>
    weights = model.init(next(rngs),
  File "/Users/pierredemetz/miniconda3/envs/pierre/lib/python3.8/site-packages/haiku/_src/transform.py", line 113, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/Users/pierredemetz/miniconda3/envs/pierre/lib/python3.8/site-packages/haiku/_src/transform.py", line 381, in init_fn
    f(*args, **kwargs)
  File "/Users/pierredemetz/UCL_work/Crick/doubledeepms/inst/python/model_creation.py", line 57, in model_fn
    folding_nonlinear_layer = StateProbFolded(model_type)(binding_additive_trait_layer,
  File "/Users/pierredemetz/miniconda3/envs/pierre/lib/python3.8/site-packages/haiku/_src/module.py", line 433, in wrapped
    out = f(*args, **kwargs)
  File "/Users/pierredemetz/miniconda3/envs/pierre/lib/python3.8/site-packages/haiku/_src/module.py", line 284, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/Users/pierredemetz/UCL_work/Crick/doubledeepms/inst/python/thermo_models.py", line 29, in __call__
    raise ValueError('model_type does not exist')
ValueError: model_type does not exist
epoch done with nan
Best: 0.119071 using {'num_samples': 128, 'learning_rate': 0.01, 'l1_regularization_factor': 0.0001, 'l2_regularization_factor': 0.0001, 'number_additive_traits': 1, 'model_type': 'tri_state_non_equilibrium_implicit'}